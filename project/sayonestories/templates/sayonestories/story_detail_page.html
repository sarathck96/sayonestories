{% extends 'base_layout.html' %}
{% load static %}
{% block addcss %}
<link rel="stylesheet" href="{% static 'css/heading.css' %}">

{% endblock %}







{% block content %}

<div class="container-fluid">

 <div class="row">
   <div class="col-12">
         <nav class="navbar navbar-expand-sm bg-dark navbar-dark">
               <!-- Brand/logo -->
               <a class="navbar-brand" href="#">
                 <img src="{{img_url.url}}" alt="Sayone" class="rounded-circle" style="width:130px;height:100px;">
                   {{user.sayone_user.name}}
               </a>


               <!-- Links -->
               <ul class="navbar-nav ml-auto">

                 <li class="nav-item">
                   <a class="nav-link lora" href="{% url 'user_profile_page' %}">My Profile </a>
                 </li>
                   <li class="nav-item">
                   <a class="nav-link lora" href="{% url 'add_story_page' %}" >Add Story</a>
                 </li>
<li class="nav-item">
                   <a class="nav-link lora" href="{% url 'logout' %}">Logout</a>
                 </li>
                    <li class="nav-item ">
                   <a class="nav-link lora" href="{% url 'user_stories_page' %}">My Stories</a>
                 </li>
               </ul>
             </nav>


   </div>
 </div>



 <div class="row">
   <div class="col-3 ">

   </div>
   <div class="col-6 pt-5">

     <div class="card">
 <div class="card-body heading2 bg-warning">{{ story.story_title}}</div>
</div>
     <div class="card pt-4">
         {% if blog %}
   <img src="{{picurl.url}}" width="100%" height="400px">
        {% endif %}

         {% if substory %}

         <div class="w3-content w3-display-container">
             {% for item in substory %}
  <img class="mySlides" src="{{ item.file.url }}" style="width:100%" height="400px">
{% endfor %}

  <button class="w3-button w3-black w3-display-left" onclick="plusDivs(-1)">&#10094;</button>
  <button class="w3-button w3-black w3-display-right" onclick="plusDivs(1)">&#10095;</button>
</div>
         {% endif %}

   </div>
     <div class="card pt-2 ">
       <h3 class="robotomono">{{story.story_author}}</h3>
       <h3 class="robotomono">{{story.date_created}}</h3>

     </div>

     <div class="card p-2 mt-2 crimson">
       {{description}}
     </div>


 </div>

       <div class="col-3 my-auto">
           <div id="counter" style="position:relative;"><b>{{story.story_likes}}</b></div>
            {% if liked == 'no' %}
           <div>
       <img src="{% static 'images/love1.jpg' %}" width="50px" height="50px" id="like">
       {% else %}
       <img src="{% static 'images/love2.jpg' %}" width="50px" height="50px" id="like" >
       {% endif %}
           </div> <br>


   </div>


</div>


    <script>
var slideIndex = 1;
showDivs(slideIndex);

function plusDivs(n) {
  showDivs(slideIndex += n);
}

function showDivs(n) {
  var i;
  var x = document.getElementsByClassName("mySlides");
  if (n > x.length) {slideIndex = 1}
  if (n < 1) {slideIndex = x.length}
  for (i = 0; i < x.length; i++) {
    x[i].style.display = "none";
  }
  x[slideIndex-1].style.display = "block";
}
</script>
<script>
var like = "{% static 'images/love2.jpg' %}"
    $(document).ready(function(){
  $("#like").click(function(){

$.ajax({
        url: "{% url 'like_story' story.story_id %}",

        dataType: 'json',
        success: function (data) {
          if (data.is_valid == 'yes' ) {
              $('#counter').html(function(i, val) { return +val+1 });
              console.log($('#counter').val());
              $("#like").attr("src",like);
          }
          else {
          alert('you have already liked this pic');
          }
        }
      });



  });
});
</script>
{% endblock %}
